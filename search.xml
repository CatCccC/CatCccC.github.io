<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[vagrant基本指南]]></title>
    <url>%2F2019%2F04%2F%3Alinux%2Fvagrant%E5%9F%BA%E6%9C%AC%E6%8C%87%E5%8D%97%2F</url>
    <content type="text"><![CDATA[安装vagrant和virtual box vagrant 下载目录 virtualbox 下载目录 安装插件 1vagrant plugin install vagrant-vbguest --plugin-clean-sources --plugin-source https://gems.ruby-china.com/ 安装开发环境Vagrant的基本单元叫做box，我们可以理解为镜像，首先我们需要添加一个Vagrant公开的镜像到我们本地，用来搭建环境。我选择的是一个centos镜像，下面的操作我们可以理解为下载镜像。 在线安装镜像123456789101112131415161718192021创建指定目录 初始化 centos7➜ test vagrant init centos/7 A `Vagrantfile` has been placed in this directory. You are nowready to `vagrant up` your first virtual environment! Please readthe comments in the Vagrantfile as well as documentation on`vagrantup.com` for more information on using Vagrant.会创建一个Vagrantfile 配置文件,此文件可以指定网卡 配置指定ip,等等虚拟机配置➜ test ls Vagrantfile启动虚拟机(本地没有镜像,则会下载镜像,由于众所周知的网络问题,下载十分缓慢)➜ test vagrant up Bringing machine 'default' up with 'virtualbox' provider...==&gt; default: Box 'centos/7' could not be found. Attempting to find and install... default: Box Provider: virtualbox default: Box Version: &gt;= 0==&gt; default: Loading metadata for box 'centos/7' default: URL: https://vagrantcloud.com/centos/7==&gt; default: Adding box 'centos/7' (v1902.01) for provider: virtualbox default: Downloading: https://vagrantcloud.com/centos/boxes/7/versions/1902.01/providers/virtualbox.box default: Download redirected to host: cloud.centos.org default: Progress: 7% (Rate: 112k/s, Estimated time remaining: 1:04:13) 离线安装镜像 离线下载镜像 例如 centos7 或者 vagrant 镜像 中寻找所需的镜像 添加镜像 1234567891011➜ test vagrant box add /data/uget/CentOS-7-x86_64-Vagrant-1902_01.VirtualBox.box ==&gt; box: Box file was not detected as metadata. Adding it directly...A name is required when adding a box file directly. Please passthe `--name` parameter to `vagrant box add`. See`vagrant box add -h` for more help.➜ test vagrant box add centos7 /data/uget/CentOS-7-x86_64-Vagrant-1902_01.VirtualBox.box==&gt; box: Box file was not detected as metadata. Adding it directly...==&gt; box: Adding box 'centos7' (v0) for provider: box: Unpacking necessary files from: file:///data/uget/CentOS-7-x86_64-Vagrant-1902_01.VirtualBox.box==&gt; box: Successfully added box 'centos7' (v0) for 'virtualbox'!➜ test 初始化,启动 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758➜ test vagrant init centos7 A `Vagrantfile` has been placed in this directory. You are nowready to `vagrant up` your first virtual environment! Please readthe comments in the Vagrantfile as well as documentation on`vagrantup.com` for more information on using Vagrant.➜ test vagrant up Bringing machine 'default' up with 'virtualbox' provider...==&gt; default: Importing base box 'centos7'...==&gt; default: Matching MAC address for NAT networking...==&gt; default: Setting the name of the VM: test_default_1553138067037_50554==&gt; default: Clearing any previously set network interfaces...==&gt; default: Preparing network interfaces based on configuration... default: Adapter 1: nat==&gt; default: Forwarding ports... default: 22 (guest) =&gt; 2222 (host) (adapter 1)==&gt; default: Booting VM...==&gt; default: Waiting for machine to boot. This may take a few minutes... default: SSH address: 127.0.0.1:2222 default: SSH username: vagrant default: SSH auth method: private key default: default: Vagrant insecure key detected. Vagrant will automatically replace default: this with a newly generated keypair for better security. default: default: Inserting generated public key within guest... default: Removing insecure key from the guest if it's present... default: Key inserted! Disconnecting and reconnecting using new SSH key...==&gt; default: Machine booted and ready![default] No Virtualbox Guest Additions installation found.Loaded plugins: fastestmirrorLoading mirror speeds from cached hostfile * base: mirrors.163.com * extras: mirrors.cn99.com * updates: mirrors.163.comPackage binutils-2.27-34.base.el7.x86_64 already installed and latest versionPackage 1:make-3.82-23.el7.x86_64 already installed and latest versionPackage bzip2-1.0.6-13.el7.x86_64 already installed and latest versionResolving Dependencies--&gt; Running transaction check................................Verifying archive integrity... All good.Uncompressing VirtualBox 6.0.4 Guest Additions for Linux........VirtualBox Guest Additions installerCopying additional installer modules ...Installing additional modules ...VirtualBox Guest Additions: Building the VirtualBox Guest Additions kernel modules. This may take a while.VirtualBox Guest Additions: To build modules for other installed kernels, runVirtualBox Guest Additions: /sbin/rcvboxadd quicksetup &lt;version&gt;VirtualBox Guest Additions: Building the modules for kernel 3.10.0-957.5.1.el7.x86_64.VirtualBox Guest Additions: Starting.Redirecting to /bin/systemctl start vboxadd.serviceRedirecting to /bin/systemctl start vboxadd-service.serviceUnmounting Virtualbox Guest Additions ISO from: /mntCleaning up downloaded VirtualBox Guest Additions ISO...==&gt; default: Checking for guest additions in VM...==&gt; default: Rsyncing folder: /data/vmbox/test/ =&gt; /vagrant 由于镜像 Virtualbox Guest Additions 未安装 ,第一次启动会安装 Virtualbox Guest Additions 耗时比较久 需要耐心等待 虚拟机操作 进入虚拟机 123➜ test vagrant sshLast login: Thu Mar 21 03:23:43 2019 from 10.0.2.2[vagrant@localhost ~]$ 虚拟机默认用户为 vagrant,密码为vagrantvagrant 默认配置sudo 免密码 私有镜像添加私有镜像私有镜像基于centos 制作,已安装docker,jdk,maven,zsh等等 1vagrant box add dev:centos7 http://xx:8086/centosdev.json 启动私有镜像12vagrant init dev:centos7 vagrant up 更新镜像原有镜像内容共享目录会销毁 123#销毁操作vagrant destroy vagrant up 打包镜像 制作不带配置的镜像 1vagrant package --output xx.box 制作带配置的镜像 1vagrant package --output xx.box --vagrantfile Vagrantfile –output：打包的名字 –vagrantfile：设置这个参数以后，就可以把Vagrantfile里面的配置打近包里面，这样其他开发人员下载镜像的时候就不需要重新配置了。 just wait , tea or coffee 镜像发布发布到vagrant仓库TODO 发布到私有仓库TODO 注意镜像升级时虚拟机内所有除共享目录下的文件 都会更新为新的镜像的内容.因此需要把私有文件保存在共享目录中]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>vagrant</tag>
        <tag>虚拟机</tag>
      </tags>
  </entry>
</search>
